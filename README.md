# BI数据分析平台

一个基于Streamlit构建的现代化BI数据分析平台，支持多种数据源的导入、数据处理、可视化分析和报表导出功能。

## 🌟 主要特性

### 📊 数据源支持
- **Excel文件** (.xlsx, .xls)
- **CSV文件** (支持多种编码格式)
- **MySQL数据库**
- **PostgreSQL数据库**
- **SQLite数据库**

### 🛠️ 数据处理功能
- 缺失值处理（删除、均值填充、中位数填充、众数填充）
- 重复值检测和删除
- 异常值检测和处理
- 数据类型自动识别和转换
- 数据标准化和归一化
- 分类变量编码

### 📈 可视化图表
- **基础图表**：柱状图、折线图、散点图、饼图
- **统计图表**：直方图、箱线图、小提琴图
- **高级图表**：热力图、雷达图、面积图
- **层次图表**：旭日图、树状图
- **多维图表**：平行坐标图
- **自定义仪表板**

### 📤 数据导出
- CSV格式导出
- Excel格式导出
- JSON格式导出
- 数据统计报告生成

## 🚀 快速开始

### 环境要求
- Python 3.8+
- 推荐使用虚拟环境

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd pyBIyoyo
```

2. **创建虚拟环境**
```bash
python -m venv venv

# Windows
venv\Scripts\activate

# macOS/Linux
source venv/bin/activate
```

3. **安装依赖**
```bash
pip install -r requirements.txt
```

4. **运行应用**
```bash
streamlit run app.py
```

5. **访问应用**
打开浏览器访问：`http://localhost:8501`

## 📖 使用指南

### 1. 数据导入

#### Excel/CSV文件导入
1. 在侧边栏选择"数据导入"
2. 选择数据源类型（Excel文件或CSV文件）
3. 上传文件
4. 对于Excel文件，选择要导入的工作表
5. 对于CSV文件，选择合适的编码格式

#### 数据库连接
1. 选择数据库类型（MySQL、PostgreSQL、SQLite）
2. 填写连接信息：
   - 主机地址
   - 端口号
   - 数据库名
   - 用户名和密码
3. 点击"连接数据库"
4. 选择要导入的数据表
5. 点击"加载数据"

### 2. 数据预览

- 查看数据基本信息（行数、列数、缺失值、重复行）
- 浏览数据表格（支持分页显示）
- 查看数据类型信息
- 查看数值列统计摘要

### 3. 数据分析

#### 数据处理
- **缺失值处理**：选择删除、均值填充、中位数填充或众数填充
- **重复值处理**：选择是否删除重复行
- 应用处理并查看处理前后对比

#### 相关性分析
- 自动生成数值变量间的相关性热力图
- 识别变量间的线性关系强度

#### 分布分析
- 选择数值列查看分布情况
- 生成直方图和箱线图
- 识别数据分布特征和异常值

### 4. 图表展示

#### 图表类型选择
- **柱状图**：适用于分类数据的比较
- **折线图**：适用于时间序列或趋势分析
- **散点图**：适用于两个数值变量的关系分析
- **饼图**：适用于比例和构成分析
- **面积图**：适用于趋势和累积分析
- **雷达图**：适用于多维数据的综合展示

#### 图表配置
- 选择X轴和Y轴变量
- 设置颜色分组（可选）
- 设置点大小（散点图）
- 自定义图表标题

### 5. 报表导出

#### 数据导出选项
- 选择导出格式（CSV、Excel、JSON）
- 设置导出范围（全部数据或指定行范围）
- 选择要导出的列（可选）

#### 统计报告
- 自动生成数据统计报告
- 包含数据概况、质量指标等信息

## 🏗️ 项目结构

```
pyBIyoyo/
├── app.py                 # 主应用文件
├── requirements.txt       # 依赖包列表
├── README.md             # 项目说明文档
└── utils/                # 工具模块
    ├── __init__.py
    ├── data_loader.py    # 数据加载器
    ├── data_processor.py # 数据处理器
    ├── chart_generator.py # 图表生成器
    └── database_connector.py # 数据库连接器
```

## 🔧 核心模块说明

### DataLoader (数据加载器)
- 支持Excel、CSV文件的读取
- 自动数据类型检测
- 数据质量验证
- 大数据集采样功能

### DataProcessor (数据处理器)
- 缺失值和重复值处理
- 异常值检测和移除
- 数据标准化和归一化
- 分类变量编码
- 数据质量分析

### ChartGenerator (图表生成器)
- 基于Plotly的交互式图表
- 支持多种图表类型
- 自定义样式和主题
- 多子图仪表板

### DatabaseConnector (数据库连接器)
- 支持多种数据库类型
- 安全的连接管理
- SQL查询执行
- 数据导入导出

## 🎨 界面特色

- **现代化UI设计**：基于Streamlit的清爽界面
- **响应式布局**：适配不同屏幕尺寸
- **交互式图表**：基于Plotly的动态可视化
- **直观的导航**：侧边栏菜单，操作流程清晰
- **实时反馈**：操作状态和结果的即时显示

## 📊 支持的数据格式

### 文件格式
- Excel: .xlsx, .xls
- CSV: 支持多种分隔符和编码
- 自动检测文件编码和分隔符

### 数据库
- MySQL 5.7+
- PostgreSQL 10+
- SQLite 3+

## 🔒 安全特性

- 数据库连接信息加密存储
- 文件上传大小限制
- SQL注入防护
- 敏感信息脱敏显示

## 🚀 性能优化

- 大数据集分页显示
- 数据采样功能
- 内存使用优化
- 异步数据加载

## 🛠️ 开发指南

### 添加新的数据源
1. 在`DataLoader`类中添加新的加载方法
2. 在主应用中添加相应的UI组件
3. 更新文档和测试

### 添加新的图表类型
1. 在`ChartGenerator`类中添加新的图表方法
2. 在图表展示页面添加选项
3. 测试图表功能

### 添加新的数据处理功能
1. 在`DataProcessor`类中实现新功能
2. 在数据分析页面添加UI控件
3. 添加相应的文档说明

## 📝 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 支持Excel、CSV、数据库数据导入
- 基础数据处理和可视化功能
- 数据导出功能

## 🤝 贡献指南

1. Fork 项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 📞 联系方式

- 项目维护者：[您的姓名]
- 邮箱：[您的邮箱]
- 项目链接：[项目地址]

## 🙏 致谢

感谢以下开源项目的支持：
- [Streamlit](https://streamlit.io/) - Web应用框架
- [Plotly](https://plotly.com/) - 交互式可视化
- [Pandas](https://pandas.pydata.org/) - 数据处理
- [SQLAlchemy](https://www.sqlalchemy.org/) - 数据库ORM

---

**享受数据分析的乐趣！** 🎉